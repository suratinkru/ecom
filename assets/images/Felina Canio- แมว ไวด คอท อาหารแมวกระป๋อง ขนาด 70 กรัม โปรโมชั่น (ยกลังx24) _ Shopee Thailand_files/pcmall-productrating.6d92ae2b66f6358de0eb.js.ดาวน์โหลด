(self.mfeModules=self.mfeModules||[]).push(["",["Platform","React","PlatformApi","Redux","ReactRedux","ReactRouter","WithInjectReducer","FeatureToggles","Account","PrometheusTracker","ReactDom"],(e,t,r,i,s,a,o,n,c,l,p)=>()=>{(self.wpJsonpPcmallRating=self.wpJsonpPcmallRating||[]).push([[190],{1473:(e,t,r)=>{"use strict";r.microfeA(e,(function(){return Promise.all([r.microfeM(0),r.microfeM(3),r.microfeM(2),r.microfeM(1),r.microfeM(4)]).then((function(){e.exports=t,r.d(t,{Z:()=>x});var i=r(3804),s=r.n(i),a=r(5325),o=r(7762),n=r(5958),c=r(9102),l=r(1534);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},p.apply(this,arguments)}const u=(0,r(5209).Z)((function(e){return s().createElement("svg",p({enableBackground:"new 0 0 15 15",viewBox:"0 0 15 15"},e),s().createElement("circle",{cx:"7.5",cy:"7.5",fill:"none",r:"6.5",strokeMiterlimit:"10"}),s().createElement("path",{stroke:"none",d:"m5.3 5.3c.1-.3.3-.6.5-.8s.4-.4.7-.5.6-.2 1-.2c.3 0 .6 0 .9.1s.5.2.7.4.4.4.5.7.2.6.2.9c0 .2 0 .4-.1.6s-.1.3-.2.5c-.1.1-.2.2-.3.3-.1.2-.2.3-.4.4-.1.1-.2.2-.3.3s-.2.2-.3.4c-.1.1-.1.2-.2.4s-.1.3-.1.5v.4h-.9v-.5c0-.3.1-.6.2-.8s.2-.4.3-.5c.2-.2.3-.3.5-.5.1-.1.3-.3.4-.4.1-.2.2-.3.3-.5s.1-.4.1-.7c0-.4-.2-.7-.4-.9s-.5-.3-.9-.3c-.3 0-.5 0-.7.1-.1.1-.3.2-.4.4-.1.1-.2.3-.3.5 0 .2-.1.5-.1.7h-.9c0-.3.1-.7.2-1zm2.8 5.1v1.2h-1.2v-1.2z"}))}),"help");var m=r(3955),h=r(3304),d=r(6911),g=r(3072),_=r(6704),f=r(4510),v=r(5526),w=r(9168);const{t:R}=_.I18n,I=({ratingScore:e,ratingCountForStarsInArray:t,ratingCountForFiltersInArray:r,selectedGenericFilter:i,onSwitchFilter:a,hideExtraFilter:o,showLocalReview:n=!1,showRepeatPurchase:c})=>{const l=[{value:1,classModifier:e=>1===e?["active","all"]:["all"],label:R("label_all")}];return[4,3,2,1,0].map((e=>{l.push({value:2<<e,label:`${e+1} ${R("label_rating_star")} (${(0,w.localizeCompactNumber)((0,m.Kd)(),t[e+1])})`,classModifier:t=>t===2<<e?["active"]:[]})})),o||(l.push({value:64,label:`${R("label_with_comment")} (${(0,w.localizeCompactNumber)((0,m.Kd)(),r[1])})`,classModifier:e=>64===e?["active","with-comment"]:["with-comment"]},{value:256,label:`${R("rating_btn_name_ratingfilter_media")} (${(0,w.localizeCompactNumber)((0,m.Kd)(),r[2])})`,classModifier:e=>256===e?["active","with-photo"]:["with-photo"]}),c&&l.push({value:32768,label:`${R("label_repeat_purchase")} (${(0,w.localizeCompactNumber)((0,m.Kd)(),r[10])})`,classModifier:e=>32768===e?["active","repeat-purchase"]:["repeat-purchase"]}),n&&l.push({value:16384,label:`${R("label_local_review")} (${(0,w.localizeCompactNumber)((0,m.Kd)(),r[9])})`,classModifier:e=>16384===e?["active","local-review"]:["local-review"]})),s().createElement("div",{className:"product-rating-overview"},s().createElement("div",{className:"product-rating-overview__briefing"},s().createElement("div",{className:"product-rating-overview__score-wrapper"},s().createElement("span",{className:"product-rating-overview__rating-score"},e%1==0?e:e&&e.toFixed(1)),s().createElement("span",{className:"product-rating-overview__rating-score-out-of"},R("text_n_out_of_m",{n:"",m:5})+" ")),s().createElement(f.DU,{rating:e,className:"product-rating-overview__stars"})),s().createElement("div",{className:"product-rating-overview__filters"},l.map((e=>s().createElement("div",{key:e.value,onClick:()=>{a(e.value)},className:(0,v.Z)("product-rating-overview__filter",e.classModifier(i))},e.label)))))};function b(e){return 1===e?{filter:0,star:0}:{filter:e>32?Math.log2(e/32):0,star:e>1&&e<=32?Math.log2(e/1):0}}const E=r.p+"eac95a8ac896158642c2761a9e9cd52e.png";function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},y.apply(this,arguments)}const{t:F}=_.I18n,P="PL"===(0,m.Kd)();class S extends i.Component{constructor(e){super(e),this._view=null,this.combineQueryFromState=(e,t)=>{const{filter:r,star:i}=b(e.genericFilter);return y({},t.queryObject,{filter:r,type:i,offset:0})},this.onSwitchPage=e=>{this.setState(((t,r)=>{const i=y({},this.combineQueryFromState(t,r),{offset:6*e}),{ratingState:s}=r,a=(0,n.kK)(s,i),o=!a||a.hasMore,c=this.props.selectItemRatings(s,i);return c&&0!==c.length||!o||this.props.fetchItemRatings(i),this.scrollToTopOfRatings(),y({},t,{selectedPage:e})}))},this.scrollToTopOfRatings=()=>{const e=window.document.documentMode;this._view&&(e?this._view.scrollIntoView():this._view.scrollIntoView({behavior:"smooth",block:"start"}))},this.onSwitchFilter=e=>{this.setState(((t,r)=>{const{filter:i,star:s}=b(e),a=y({},this.combineQueryFromState(t,r),{filter:i,type:s});this.props.onFilterTypeChanged&&this.props.onFilterTypeChanged(s);const{ratingState:o}=r,n=this.props.selectItemRatings(o,a);return n&&0!==n.length||this.props.fetchItemRatings(a),y({},t,{selectedPage:0,genericFilter:e})}))};const t=Number.isInteger(this.props.filterType)&&null!=this.props.filterType?1<<this.props.filterType:1;this.state={selectedPage:0,genericFilter:t}}UNSAFE_componentWillMount(){this.props.injectAsyncReducer({rating:n.I6});const e=this.combineQueryFromState(this.state,this.props),{ratingState:t}=this.props,r=this.props.selectItemRatings(t,e);r&&0!==r.length||this.props.fetchItemRatings(e)}componentDidUpdate(e){this.props.itemId!==e.itemId&&this.setState({selectedPage:0,genericFilter:1}),this.props.filterType!==e.filterType&&null!=this.props.filterType&&Number.isInteger(this.props.filterType)&&this.setState({genericFilter:1<<this.props.filterType})}render(){const{productRating:e,ratingState:t,shopId:r,ratingStar:s,selectItemRatings:a}=this.props,o=e.ratingCount,c=this.state.genericFilter?parseInt(`${this.state.genericFilter}`,10):1,{filter:p,star:m}=b(c),g=y({},this.props.queryObject,{filter:p,type:m,offset:6*this.state.selectedPage}),_=(0,n.kK)(t,g),f=!!_&&_.downgradeSwitch,v=!_||_.hasMore,w=_?v?_.offset:_.offset-6:0,R=t&&a(t,g),S=o?o[m]:0,N=o||[0,0,0,0,0,0],x=[0,null!=e.rcountWithCmt?e.rcountWithCmt:0,null!=e.rcountWithImg?e.rcountWithImg:0,null!=e.rcountWithImg?e.rcountWithImg:0,0,0,0,0,0,e.rcountLocalReview||0,e.rcountRepeatPurchase||0],M=0!==p?x[p]:S;return i.createElement("div",{className:"product-ratings",ref:e=>{this._view=e},"data-nosnippet":!0},i.createElement("div",{className:"product-ratings__header"},!this.props.isUserRating&&i.createElement("div",{className:"product-ratings__header_score"},F("label_product_ratings")),P&&i.createElement(l.ve,{content:i.createElement(u,{className:"product_ratings_icon_help"}),showPosition:"center",showContent:i.createElement("div",{className:"product_ratings_drawer_container",dangerouslySetInnerHTML:{__html:F("pdp_star_reviews_drawer_content")}})})),!f&&i.createElement(I,{ratingScore:s,ratingCountForStarsInArray:N,ratingCountForFiltersInArray:x,selectedGenericFilter:c,onSwitchFilter:this.onSwitchFilter,hideExtraFilter:this.props.hideExtraFilter,showLocalReview:t.show_local_review,showRepeatPurchase:!!(e.rcountRepeatPurchase&&e.rcountRepeatPurchase>0)}),f&&0===M&&0===(null==_?void 0:_.ratings.length)||!f&&0===M?i.createElement("div",{className:"product-ratings-comments-view__no-data"},i.createElement("div",{className:"product-ratings-comments-view__no-data__icon"},i.createElement("img",{src:E})),i.createElement("div",{className:"product-ratings-comments-view__no-data__text"},F("text_no_ratings")),this.props.isUserRating&&i.createElement("div",{className:"product-ratings-comments-view__no-data__desc"},F("label_buyer_rating_empty_desc"))):i.createElement("div",{className:"product-ratings__list"},i.createElement("div",{className:"shopee-product-comment-list"},!!R&&R.map((e=>e&&i.createElement(d.Z,{key:e.cmtid,rating:e,shopId:r,itemId:e.itemid,noAction:this.props.noAction,likeRating:this.props.likeRating,unlikeRating:this.props.unlikeRating,productItems:e.product_items,isUserRating:this.props.isUserRating,showProducts:this.props.showProducts})))),i.createElement(h.ZP,{className:"product-ratings__page-controller",totalPageCount:Math.floor((f?w:M-1)/6)+1,selectedPage:this.state.selectedPage,onPageSelected:this.onSwitchPage})))}}S.defaultProps={selectItemRatings:n.N7};const N={rating_total:0,rating_count:[0,0,0,0,0],rcount_with_context:0,rcount_with_image:0,rcount_with_media:0,rcount_local_review:0,rcount_repeat_purchase:0},x=(0,c.Pf)((0,a.connect)(((e,t)=>{const{shopId:r,userId:i,itemId:s}=t,a=e.rating,o={shopId:r,itemId:s,userId:i,flag:1,limit:6},c=(t.selectItemRatingSummary||n.EM)(a)||N;return{queryObject:o,ratingState:a,productRating:{ratingCount:[c.rating_total,...c.rating_count.length?c.rating_count:[0,0,0,0,0]],rcountWithCmt:c.rcount_with_context,rcountWithImg:c.rcount_with_media,rcountLocalReview:c.rcount_local_review,rcountRepeatPurchase:c.rcount_repeat_purchase}}}),((e,t)=>({fetchItemRatings:r=>{t.fetchItemRatings?t.fetchItemRatings(r):e((0,n._L)(r))}})))((0,o.withInjectReducer)((0,g.wl)(S))))}))}))},17:e=>{"use strict";e.exports=c},1437:e=>{"use strict";e.exports=n},6161:t=>{"use strict";t.exports=e},6704:e=>{"use strict";e.exports=r},3332:e=>{"use strict";e.exports=l},3804:e=>{"use strict";e.exports=t},7274:e=>{"use strict";e.exports=p},5325:e=>{"use strict";e.exports=s},6775:e=>{"use strict";e.exports=a},4857:e=>{"use strict";e.exports=i},7762:e=>{"use strict";e.exports=o}},function(t){"use strict";var r;r=t.x,t.x=()=>{Promise.resolve(t(1473)).then((t=>{e.setModule("pcmall-productrating",t.Z),r()}))}},[[1473,666,843,84]]])},2]),function(){if(window&&window.__DECKER_HOOK__){var e=window.__DECKER_HOOK__,t=function(){e.sendToDevtools("MFE_LOAD_SLOT",{slotName:"pcmall-productrating",tag:"RT-V20230216-WEB",branch:"heads/RT-V20230216-WEB",lastCommit:"feat: simplify config",lastCommitHash:"9ce02f7528e0933c17180385b3fa2374fda1465a",updated:"2023-02-13T11:03:28.892Z"})};e.on("MFE_RETRIEVE_SLOTS",t),t()}}();